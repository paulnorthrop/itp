<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Interpolate, Truncate, Project (ITP) Root-Finding Algorithm • itp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="The Interpolate, Truncate, Project (ITP) Root-Finding Algorithm">
<meta property="og:description" content="Implements the Interpolate, Truncate, Project (ITP) root-finding 
    algorithm developed by Oliveira and Takahashi (2021) &lt;doi:10.1145/3423597&gt;.
    The user provides the function, from the real numbers to the real numbers, 
    and an interval with the property that the values of the function at its 
    endpoints have different signs. If the function is continuous over this 
    interval then the ITP method estimates the value at which the function is 
    equal to zero. If the function is discontinuous then a point of 
    discontinuity at which the function changes sign may be found. 
    The function can be supplied using either an R function or an external 
    pointer to a C++ function. Tuning parameters of the ITP algorithm can be 
    set by the user. Default values are set based on arguments in Oliveira and 
    Takahashi (2021). ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">itp</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/itp-vignette.html">Overview of the itp package</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paulnorthrop/itp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="itp">itp<a class="anchor" aria-label="anchor" href="#itp"></a>
</h1></div>

<div class="section level2">
<h2 id="the-interpolate-truncate-project-itp-root-finding-algorithm">The Interpolate, Truncate, Project (ITP) Root-Finding Algorithm<a class="anchor" aria-label="anchor" href="#the-interpolate-truncate-project-itp-root-finding-algorithm"></a>
</h2>
<p>The <strong>itp</strong> package implements the Interpolate, Truncate, Project (ITP) root-finding algorithm of <a href="https://doi.org/10.1145/3423597" class="external-link">Oliveira and Takahashi (2021)</a>. Each iteration of the algorithm results in a bracketing interval for the root that is narrower than the previous interval. It’s performance compares favourably with existing methods on both well-behaved functions and ill-behaved functions while retaining the worst-case reliability of the bisection method. For details see the authors’ <a href="https://www.growkudos.com/publications/10.1145%25252F3423597/reader" class="external-link">Kudos summary</a> and the Wikipedia article <a href="https://en.wikipedia.org/wiki/ITP_method" class="external-link">ITP method</a>.</p>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>We use three examples from Section 3 of <a href="https://doi.org/10.1145/3423597" class="external-link">Oliveira and Takahashi (2021)</a> to illustrate the use of the <code>itp</code> function. Each of these functions has a root in the interval <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%28-1%2C%201%29" title="(-1, 1)" alt="(-1, 1)">. The function can be supplied either as an R function or as an external pointer to a C++ function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/itp/" class="external-link">itp</a></span><span class="op">)</span></code></pre></div>
<div class="section level4">
<h4 id="a-continuous-function">A continuous function<a class="anchor" aria-label="anchor" href="#a-continuous-function"></a>
</h4>
<p>The Lambert function <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;l%28x%29%20%3D%20xe%5Ex%20-%201" title="l(x) = xe^x - 1" alt="l(x) = xe^x - 1"> is continuous.</p>
<p><img src="reference/figures/README-lambert-1.png" style="display: block; margin: auto;"></p>
<p>The <code>itp</code> function finds an estimate of the root, that is, <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;x%5E%2A" title="x^*" alt="x^*"> for which <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;f%28x%5E%2A%29" title="f(x^*)" alt="f(x^*)"> is (approximately) equal to 0. The algorithm continues until the length of the interval that brackets the root is smaller than <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;2%20%5Cepsilon" title="2 \epsilon" alt="2 \epsilon">, where <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Cepsilon" title="\epsilon" alt="\epsilon"> is a user-supplied tolerance. The default is <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5Cepsilon%20%3D%2010%5E%7B-10%7D" title="\epsilon = 10^{-10}" alt="\epsilon = 10^{-10}">.</p>
<p>First, we supply an R function that evaluates the Lambert function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Lambert, using an R function</span>
<span class="va">lambert</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
<span class="fu"><a href="reference/itp.html">itp</a></span><span class="op">(</span><span class="va">lambert</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; function: lambert </span>
<span class="co">#&gt;       root     f(root)  iterations  </span>
<span class="co">#&gt;     0.5671   2.048e-12           8</span></code></pre></div>
<p>Now, we create an external pointer to a C++ function that has been provided in the <code>itp</code> package and pass this pointer to the function <code><a href="reference/itp.html">itp()</a></code>. For more information see the <a href="https://paulnorthrop.github.io/itp/articles/itp-vignette.html" class="external-link">Overview of the itp package</a> vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Lambert, using an external pointer to a C++ function</span>
<span class="va">lambert_ptr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/xptr_create.html">xptr_create</a></span><span class="op">(</span><span class="st">"lambert"</span><span class="op">)</span>
<span class="fu"><a href="reference/itp.html">itp</a></span><span class="op">(</span><span class="va">lambert_ptr</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; function: lambert_ptr </span>
<span class="co">#&gt;       root     f(root)  iterations  </span>
<span class="co">#&gt;     0.5671   2.048e-12           8</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="a-discontinuous-function">A discontinuous function<a class="anchor" aria-label="anchor" href="#a-discontinuous-function"></a>
</h4>
<p>The staircase function <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;s%28x%29%20%3D%20%5Clceil%2010%20x%20-%201%20%5Crceil%20%2B%201%2F2" title="s(x) = \lceil 10 x - 1 \rceil + 1/2" alt="s(x) = \lceil 10 x - 1 \rceil + 1/2"> is discontinuous.</p>
<p><img src="reference/figures/README-staircase-1.png" style="display: block; margin: auto;"></p>
<p>The <code>itp</code> function finds the discontinuity at <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;x%20%3D%200" title="x = 0" alt="x = 0"> at which the sign of the function changes. The value of 0.5 returned for the root <code>res$root</code> is the midpoint of the bracketing interval <code>[res$a, res$b]</code> at convergence.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Staircase</span>
<span class="va">staircase</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="va">x</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/itp.html">itp</a></span><span class="op">(</span><span class="va">staircase</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; function: staircase </span>
<span class="co">#&gt;       root     f(root)  iterations           a           b         f.a  </span>
<span class="co">#&gt;  7.404e-11         0.5          31           0   1.481e-10        -0.5  </span>
<span class="co">#&gt;        f.b   precision  </span>
<span class="co">#&gt;        0.5   7.404e-11</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="a-function-with-multiple-roots">A function with multiple roots<a class="anchor" aria-label="anchor" href="#a-function-with-multiple-roots"></a>
</h4>
<p>The Warsaw function <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;w%28x%29%20%3D%20I%28x%20%3E%20-1%29%5Cleft%281%20%2B%20%5Csin%5Cleft%28%5Cfrac%7B1%7D%7B1%2Bx%7D%5Cright%29%5Cright%29-1" title="w(x) = I(x &gt; -1)\left(1 + \sin\left(\frac{1}{1+x}\right)\right)-1" alt="w(x) = I(x &gt; -1)\left(1 + \sin\left(\frac{1}{1+x}\right)\right)-1"> has multiple roots.</p>
<p><img src="reference/figures/README-warsaw-1.png" style="display: block; margin: auto;"></p>
<p>When the initial interval is <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;%5B-1%2C%201%5D" title="[-1, 1]" alt="[-1, 1]"> the <code>itp</code> function finds the root <img src="https://latex.codecogs.com/png.image?%5Cdpi%7B110%7D&amp;space;%5Cbg_white&amp;space;x%20%5Capprox%20-0.6817" title="x \approx -0.6817" alt="x \approx -0.6817">. There are other roots that could be found from a different initial interval.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Warsaw</span>
<span class="va">warsaw</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="reference/itp.html">itp</a></span><span class="op">(</span><span class="va">warsaw</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; function: warsaw </span>
<span class="co">#&gt;       root     f(root)  iterations  </span>
<span class="co">#&gt;    -0.6817  -5.472e-11          11</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>To get the current released version from CRAN:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"itp"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="vignette">Vignette<a class="anchor" aria-label="anchor" href="#vignette"></a>
</h3>
<p>See <code><a href="articles/itp-vignette.html">vignette("itp-vignette", package = "itp")</a></code> for an overview of the package.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=itp" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/paulnorthrop/itp/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/paulnorthrop/itp/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing itp</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Paul J. Northrop <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://ci.appveyor.com/project/paulnorthrop/itp" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/paulnorthrop/itp?branch=main&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://github.com/paulnorthrop/itp/actions" class="external-link"><img src="https://github.com/paulnorthrop/itp/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/github/paulnorthrop/itp?branch=main" class="external-link"><img src="https://codecov.io/github/paulnorthrop/itp/coverage.svg?branch=main" alt="Coverage Status"></a></li>
<li><a href="https://cran.r-project.org/package=itp" class="external-link"><img src="https://www.r-pkg.org/badges/version/itp" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=itp" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/itp?color=brightgreen" alt="Downloads (monthly)"></a></li>
<li><a href="https://cran.r-project.org/package=itp" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/itp?color=brightgreen" alt="Downloads (total)"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
