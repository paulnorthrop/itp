<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Interpolate, Truncate, Project (ITP) Root-Finding Algorithm • itp</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="The Interpolate, Truncate, Project (ITP) Root-Finding Algorithm">
<meta name="description" content="Implements the Interpolate, Truncate, Project (ITP) root-finding algorithm developed by Oliveira and Takahashi (2021) &lt;doi:10.1145/3423597&gt;. The user provides the function, from the real numbers to the real numbers, and an interval with the property that the values of the function at its endpoints have different signs. If the function is continuous over this interval then the ITP method estimates the value at which the function is equal to zero. If the function is discontinuous then a point of discontinuity at which the function changes sign may be found. The function can be supplied using either an R function or an external pointer to a C++ function. Tuning parameters of the ITP algorithm can be set by the user. Default values are set based on arguments in Oliveira and Takahashi (2021).">
<meta property="og:description" content="Implements the Interpolate, Truncate, Project (ITP) root-finding algorithm developed by Oliveira and Takahashi (2021) &lt;doi:10.1145/3423597&gt;. The user provides the function, from the real numbers to the real numbers, and an interval with the property that the values of the function at its endpoints have different signs. If the function is continuous over this interval then the ITP method estimates the value at which the function is equal to zero. If the function is discontinuous then a point of discontinuity at which the function changes sign may be found. The function can be supplied using either an R function or an external pointer to a C++ function. Tuning parameters of the ITP algorithm can be set by the user. Default values are set based on arguments in Oliveira and Takahashi (2021).">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">itp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/itp-vignette.html">Overview of the itp package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/paulnorthrop/itp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="itp">itp<a class="anchor" aria-label="anchor" href="#itp"></a>
</h1></div>
<p><a href="https://github.com/paulnorthrop/itp/actions/workflows/R-CMD-check.yaml"><img src="https://github.com/paulnorthrop/itp/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://app.codecov.io/github/paulnorthrop/itp?branch=main" class="external-link"><img src="https://codecov.io/github/paulnorthrop/itp/coverage.svg?branch=main" alt="Coverage Status"></a> <a href="https://cran.r-project.org/package=itp" class="external-link"><img src="https://www.r-pkg.org/badges/version/itp" alt="CRAN_Status_Badge"></a> <a href="https://cran.r-project.org/package=itp" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/itp?color=brightgreen" alt="Downloads (monthly)"></a> <a href="https://cran.r-project.org/package=itp" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/itp?color=brightgreen" alt="Downloads (total)"></a></p>
<div class="section level2">
<h2 id="the-interpolate-truncate-project-itp-root-finding-algorithm">The Interpolate, Truncate, Project (ITP) Root-Finding Algorithm<a class="anchor" aria-label="anchor" href="#the-interpolate-truncate-project-itp-root-finding-algorithm"></a>
</h2>
<p>The <strong>itp</strong> package implements the Interpolate, Truncate, Project (ITP) root-finding algorithm of <a href="https://doi.org/10.1145/3423597" class="external-link">Oliveira and Takahashi (2021)</a>. Each iteration of the algorithm results in a bracketing interval for the root that is narrower than the previous interval. It’s performance compares favourably with existing methods on both well-behaved functions and ill-behaved functions while retaining the worst-case reliability of the bisection method. For details see the authors’ <a href="https://www.growkudos.com/publications/10.1145%25252F3423597/reader" class="external-link">Kudos summary</a> and the Wikipedia article <a href="https://en.wikipedia.org/wiki/ITP_method" class="external-link">ITP method</a>.</p>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>We use three examples from Section 3 of <a href="https://doi.org/10.1145/3423597" class="external-link">Oliveira and Takahashi (2021)</a> to illustrate the use of the <code>itp</code> function. Each of these functions has a root in the interval <span class="math inline">\((-1, 1)\)</span>. The function can be supplied either as an R function or as an external pointer to a C++ function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/itp/" class="external-link">itp</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="a-continuous-function">A continuous function<a class="anchor" aria-label="anchor" href="#a-continuous-function"></a>
</h4>
<p>The Lambert function <span class="math inline">\(l(x) = xe^x - 1\)</span> is continuous.</p>
<p><img src="reference/figures/README-lambert-1.png" style="display: block; margin: auto;"></p>
<p>The <code>itp</code> function finds an estimate of the root, that is, <span class="math inline">\(x^{\ast}\)</span> for which <span class="math inline">\(f(x^{\ast})\)</span> is (approximately) equal to 0. The algorithm continues until the length of the interval that brackets the root is smaller than <span class="math inline">\(2 \epsilon\)</span>, where <span class="math inline">\(\epsilon\)</span> is a user-supplied tolerance. The default is <span class="math inline">\(\epsilon = 10^{-10}\)</span>.</p>
<p>First, we supply an R function that evaluates the Lambert function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lambert, using an R function</span></span>
<span><span class="va">lambert</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="reference/itp.html">itp</a></span><span class="op">(</span><span class="va">lambert</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; function: lambert </span></span>
<span><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span><span class="co">#&gt;     0.5671   2.048e-12           8</span></span></code></pre></div>
<p>Now, we create an external pointer to a C++ function that has been provided in the <code>itp</code> package and pass this pointer to the function <code><a href="reference/itp.html">itp()</a></code>. For more information see the <a href="https://paulnorthrop.github.io/itp/articles/itp-vignette.html" class="external-link">Overview of the itp package</a> vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lambert, using an external pointer to a C++ function</span></span>
<span><span class="va">lambert_ptr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/xptr_create.html">xptr_create</a></span><span class="op">(</span><span class="st">"lambert"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/itp.html">itp</a></span><span class="op">(</span><span class="va">lambert_ptr</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; function: lambert_ptr </span></span>
<span><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span><span class="co">#&gt;     0.5671   2.048e-12           8</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-function-itp_c">The function <code>itp_c</code>
<a class="anchor" aria-label="anchor" href="#the-function-itp_c"></a>
</h4>
<p>Also provided is the function <code>itp_c</code>, which is equivalent to <code>itp</code>, but the calculations are performed entirely using C++, and the arguments differ slightly: <code>itp_c</code> has a named required argument <code>pars</code> rather than <code>...</code> and it does not have the arguments <code>interval</code>, <code>f.a</code> or <code>f.b</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calling itp_c()</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/itp_c.html">itp_c</a></span><span class="op">(</span><span class="va">lambert_ptr</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, a <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; function:  </span></span>
<span><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span><span class="co">#&gt;     0.5671   2.048e-12           8</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="a-discontinuous-function">A discontinuous function<a class="anchor" aria-label="anchor" href="#a-discontinuous-function"></a>
</h4>
<p>The staircase function <span class="math inline">\(s(x) = \lceil 10 x - 1 \rceil + 1/2\)</span> is discontinuous.</p>
<p><img src="reference/figures/README-staircase-1.png" style="display: block; margin: auto;"></p>
<p>The <code>itp</code> function finds the discontinuity at <span class="math inline">\(x = 0\)</span> at which the sign of the function changes. The value of 0.5 returned for the root <code>res$root</code> is the midpoint of the bracketing interval <code>[res$a, res$b]</code> at convergence.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Staircase</span></span>
<span><span class="va">staircase</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">*</span> <span class="va">x</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/itp.html">itp</a></span><span class="op">(</span><span class="va">staircase</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; function: staircase </span></span>
<span><span class="co">#&gt;       root     f(root)  iterations           a           b         f.a  </span></span>
<span><span class="co">#&gt;  7.404e-11         0.5          31           0   1.481e-10        -0.5  </span></span>
<span><span class="co">#&gt;        f.b   precision  </span></span>
<span><span class="co">#&gt;        0.5   7.404e-11</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="a-function-with-multiple-roots">A function with multiple roots<a class="anchor" aria-label="anchor" href="#a-function-with-multiple-roots"></a>
</h4>
<p>The Warsaw function <span class="math inline">\(w(x) = I(x &gt; -1)\left(1 + \sin\left(\frac{1}{1+x}\right)\right)-1\)</span> has multiple roots.</p>
<p><img src="reference/figures/README-warsaw-1.png" style="display: block; margin: auto;"></p>
<p>When the initial interval is <span class="math inline">\([-1, 1]\)</span> the <code>itp</code> function finds the root <span class="math inline">\(x \approx -0.6817\)</span>. There are other roots that could be found from a different initial interval.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Warsaw</span></span>
<span><span class="va">warsaw</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/itp.html">itp</a></span><span class="op">(</span><span class="va">warsaw</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; function: warsaw </span></span>
<span><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span><span class="co">#&gt;    -0.6817  -5.472e-11          11</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>To get the current released version from CRAN:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"itp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="vignette">Vignette<a class="anchor" aria-label="anchor" href="#vignette"></a>
</h3>
<p>See the <a href="https://paulnorthrop.github.io/itp/articles/itp-vignette.html" class="external-link">Overview of the itp package</a> vignette, which can also be accessed using <code><a href="articles/itp-vignette.html">vignette("itp-vignette", package = "itp")</a></code>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=itp" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/paulnorthrop/itp/">Browse source code</a></li>
<li><a href="https://github.com/paulnorthrop/itp/issues">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing itp</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Paul J. Northrop <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul J. Northrop.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
